<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>blog.wamser.eu - What the hype? The DROWN attack on SSL.</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">blog.wamser.eu</a>
            </div>
            <div id="navigation">
                <a href="../about.html">About</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>What the hype? The DROWN attack on SSL.</h1>

            <div class="info">
    Posted on March  2, 2016
    
</div>

<p>So everyone<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> <a href="http://www.theregister.co.uk/2016/03/01/drown_tls_protocol_flaw/">is</a> <a href="http://arstechnica.com/security/2016/03/more-than-13-million-https-websites-imperiled-by-new-decryption-attack/">going</a> <a href="http://www.theregister.co.uk/2016/03/01/drown_crypto_flaw_analysis/">bananas</a> about the <a href="https://www.drownattack.com/">DROWN attack</a> these days.</p>
<p>If you want a good detailed write-up, head over to <a href="http://blog.cryptographyengineering.com/2016/03/attack-of-week-drown.html">Matthew Green’s blog</a>, where you can also find pointers to all the gory details, if you dare look at them.</p>
<p>From my side, here’s a quick overview on what this is all about.</p>
<h3 id="first-is-the-hype-justified">First, is the hype justified?</h3>
<p>Yes, definitely.</p>
<p>Not only because it is a serious thread, but also it is a great example for old crypto that should have long vanished from any deployed code. And now it is creeping up from the grave to stab your back.</p>
<h3 id="what-can-i-do-to-protect-myself">What can I do to protect myself?</h3>
<p>If you are running a server: Check, Patch, Check again.</p>
<p>If you are a user: nothing. This is pretty much a server-only-problem.</p>
<h3 id="so-what-is-exactly-going-on">So, what is exactly going on?</h3>
<p>Well, the root of the problem goes back to the times when crypto was still subject to export controls. Back then, when you wanted to make a secure connection to a web server (like entering <code>https://</code> in the location bar to get that lock icon), a protocol called <em>SSLv2</em> was used to establish a secret key between your browser and the server to protect all communication. And for export control reasons only short keys were used. Keys so short your smartphone can probably crack them within a few days.</p>
<p>Don’t get me wrong, this protocol (SSLv2) is already quite sophisticated. But as no one had designed something similar before, is also has its weaknesses and it has been broken quite a few times. But things improved and a new generation called <code>TLS</code> was designed, which avoids many of the flaws. Among them the then-mandatory weak crypto. Nowadays your browser uses <code>TLS v1.2</code> or <code>TLS v1.3</code> when doing that <code>https:</code>-thingy. Most likely it will refuse to speak <code>SSLv2</code> if it remembers that ancestor of old at all.</p>
<p>On the other side however, quite a few servers — the researches behind DROWN report about a third of all on the great internets — are willing to answer your request in <code>SSLv2</code>. Even that would not make for a problem, wasn’t it also for some laziness. The thing is that basically your computer is encrypting data with the public key of the server and the server decrypts it with his private key. Now, due to laziness, the same private key is used for the <code>TLS</code> and the <code>SSL</code> kind of communication. At some point during the <code>TLS</code> protocol setup a master secret is transmitted to the server, encrypted with the public key. This by itself is not an issue. <code>TLS</code> then derives a key to do the actual bulk encryption and the master secret is never used as is. This is perfectly fine.<br />
What an attacker can do, is re-route the <code>TLS</code> communication to the <code>SSL</code> part of the same server. Because of the similarity of the protocols the <code>SSL</code> part will accept the messages and decrypt them with the same private key as for <code>TLS</code>. The problem is that for one <code>SSL</code> uses the master secret directly to encrypt data and that ridiculously weak crypto is used (remember the export restrictions!). All an attacker has to do, is to send a few thousand slightly modifed versions of the captured data packets to the <code>SSL</code> server, record the responses and hand them over to a a few servers rented from Amazon’s cloud to do the grunt work. For just a few hundred dollars a recorded session can then be decrypted.</p>
<h3 id="ok-but-why-should-i-be-a-target">Ok, but why should I be a target?</h3>
<p>It may not be worth the hassle to get your banking credentials (phishing may be easier) to empty your account. But what about a bit of blackmailing because you have some “private expenses” on the statement? I won’t tell anyone about the flowers to the bosses’ wife if you just plug in that USB Stick an run that software at work.</p>
<h3 id="the-bottom-line.">The bottom line.</h3>
<p>Kill it. Kill it with fire and kill it for good. There is no reason to still support that old, weak crypto stuff.</p>
<p>And if you do not want to read pretty much the same blog post again in a few years, watch your politicians. There a quite a few that advocate <em>weakening crypto by law</em>. To catch the terrorists. As if terrorists give a sh*** about the law.</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>sursprisingly Wired had no article online at the time of writing<a href="#fnref1">↩</a></p></li>
</ol>
</div>

        </div>
        <div id="footer">
            <a href="../impressum.html">Impressum</a>
        </div>
    </body>
</html>
